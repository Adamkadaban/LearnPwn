#!/bin/python3
from pwn import *


def betterFib(n):
    num1=0
    num2=1
    for i in range(2,n+1):
        num1, num2 = num2, num1+num2
    return num2

# open the binary as a pwntools ELF object
e = ELF('./be-quick-or-be-dead-2')


# get the correct key as a result of the fib function
# 0x43b was pulled from ghidra disassembly
newFibVal = betterFib(0x43b) 

# make the value into hex and turn it into a 32 bit value
newFibVal = hex(newFibVal & (2**32 - 1))

# patch the binary to instead return our calculated key
e.asm( e.symbols['fib'], 'mov eax, %s\nret\n' % newFibVal) 

# save the patched binary
e.save('./newBinary') 