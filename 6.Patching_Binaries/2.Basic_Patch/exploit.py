#!/bin/python3

import matplotlib.pyplot as plt
from pwn import *
vals = {}


def calc(n):
	if n in vals:
		return vals[n]
	if n < 5:
		r = n * n + 0x2345
	else:
		a = calc(n - 1)
		b = calc(n - 2)
		c = calc(n - 3)
		d = calc(n - 4)
		e = calc(n - 5)
		r = e*0x1234 + (a - b) + (c - d)
	if n not in vals:
		vals[n] = r
	return r

# def better_calc(n):
# 	vals = {}
# 	currVal = n
# 	while True:
# 		if 

n = 0x18e9f
for i in range(n):
	calc(i)

v = calc(n)

e = ELF('./be-quick-or-be-dead-3')

v = hex(v & (2**32 - 1))

e.asm( e.sym['calc'], 'mov eax, %s\nret\n' % v)

e.save('./newBinary')

